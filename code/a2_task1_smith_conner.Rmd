---
title: "Assignment 2 - Task 1"
author: "Conner Smith"
date: "1/27/2022"
output: 
  html_document: 
    theme: flatly
    code_folding: hide
---

```{r setup, include=TRUE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(tidyverse)
library(here)
library(ggbeeswarm)
library(broom)
library(jtools)
library(caret)
library(AICcmodavg)
library(cowplot)
```

## **Overview**

This anslysis looks at the survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017. It uses binary logistic regression to predict whether a palmetto is species Serenoa repens or Sabal etonia. Data was collected by the Environemntal Data Initiative. 

## **Analysis**

This analysis uses binary logistic regression to test feasibility of using variables plant height (height), canopy length (length), canopy width (width), and number of green leaves (green_lvs) to classify whether a palmetto is species Serenoa repens or Sabal etonia. 

```{r}
# Read in the data 

palmetto <- read_csv(here("data", "all_palmetto_data.csv"))
```

#### **Figure 1:** *...*

```{r}
# Create 2 finalized data visualizations exploring differences in height, canopy length, canopy width, and green leaves for the two species. Note: species code 1 is Serenoa repens and species code 2 is Sabal etonia. 

palmetto_clean <- palmetto %>% 
  select(year, species, height:green_lvs) %>% 
  mutate(species = case_when(species == "1" ~ "Serenoa repens",
                   species == "2" ~ "Serenoa etonia"))

height <- ggplot(data = palmetto_clean, aes(x = species, y = height)) +
  geom_beeswarm(aes(color = species), 
                dodge.width = 0, cex = 0.4, size = 0.2,
                show.legend = FALSE) +
  geom_boxplot(fill = NA, width = 0.2, color = 'darkslategray',
               outlier.color = NA) +
  stat_summary(fun.y = "mean",
               col = "darkslategray",
               shape = 18) +
  scale_color_manual(values = c("darkolivegreen3", "seagreen")) +
  theme_bw() +
  labs(x = "Species", y = "Height (cm)")


leaves <- ggplot(data = palmetto_clean, aes(x = green_lvs)) +
  geom_histogram(aes(fill = species), color = "darkslategray",
                 binwidth = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("darkolivegreen3", "seagreen")) +
  facet_wrap(~ species) +
  theme_bw() +
  labs(x = "Green Leaves (number)", y = "Count")


title <- ggdraw() + 
  draw_label(
    "Figure 1: Paletto Height and Leaf Count by Species",
    fontface = 'bold',
    x = 0,
    hjust = 0) +
  theme(plot.margin = margin(0, 0, 0, 7))


plots <- plot_grid(height, leaves,
                   ncol = 2,
                   rel_widths = c(1, 1))

plot_grid(title, plots, ncol = 1,
          rel_heights = c(0.1, 1, 0.1))
```


### **Data Citation**

*Abrahamson, W.G. 2019. Survival, growth and biomass estimates of two dominant palmetto species of south-central Florida from 1981 - 2017, ongoing at 5-year intervals ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/f2f96ec76fbbd4b9db431c79a770c4d5*
